####################################################
# GEANT4 VCGLIB/CAD INTERFACE
#
# File:      Makefile
#
# Author:    Christopher M Poole,
# Email:     mail@christopherpoole.net
#
# Date:      7th April, 2011
####################################################

$CC = g++

.PHONY: all
all: libcadmesh.so

include $(G4INSTALL)/config/binmake.gmk

libcadmesh.so: src/CADMesh.o @vcglib_dir@@plylib_object@
	$(CC) -shared -o libcadmesh.so src/CADMesh.o @vcglib_dir@@plylib_object@ @tetgen_lib@

src/CADMesh.o: src/CADMesh.cc
	$(CC) -g -fPIC -w -Iinclude/ @vcglib_incflag@@vcglib_dir@ @tetgen_incflag@@tetgen_dir@ @qt_incflag@@qt_dir@@qt_subdir@ @qt_incflag@@qt_dir@ $(INCFLAGS) -I$(CLHEP_INCLUDE_DIR) -c src/CADMesh.cc -o src/CADMesh.o @disable_vcglib@ @disable_tetgen@ @disable_collada@ @debug@

@vcglib_dir@/wrap/ply/plylib.o: @vcglib_dir@/wrap/ply/plylib.cpp
	$(CC) -g -fPIC -c @vcglib_dir@/wrap/ply/plylib.cpp -o @vcglib_dir@/wrap/ply/plylib.o

install:
	cp libcadmesh.so @prefix@/lib/libcadmesh.so
	cp include/CADMesh.hh @prefix@/include/CADMesh.hh

#remove:
#	rm @prefix@/lib/libcadmesh.so @prefix@/include/CADMesh.hh

